@using System.Reflection
@using GeeksCoreLibrary.Core.Cms.Attributes
@model List<Api.Modules.Templates.Models.History.HistoryVersionModel>
<div class="row historyHeader">
    <div class="col col-6">
        <h3>Oud</h3>
    </div>
    <div class="col col-6">
        <h3>Nieuw</h3>
    </div>
</div>

<div class="col col-12 historyTagline" id="revertChanges">
    <button role="button" class="k-button" title="View HTML" aria-label="View HTML">
        <span class="k-icon k-i-undo"></span>
        <span class="k-button-text">Ongedaan maken</span>
    </button>
</div>
@foreach (var historyVersion in Model)
{
    <div class="row historyLine" data-historyversion="@historyVersion.Version">
        <div class="col col-12 historyTagline">
            <span><span class="k-icon k-i-edit"></span> Versie @historyVersion.Version |</span>
            <span><span class="k-icon k-i-calendar"></span> @historyVersion.GetDisplayChangedOn() |</span>
            <span><span class="k-icon k-i-user"></span> door @historyVersion.ChangedBy</span>
        </div>
        @if (historyVersion.Changes != null)
        {
            @foreach (var historyChange in historyVersion.Changes)
            {
                var propertyAttribute = historyChange.GetPropertyAttribute();
                var property = historyChange.GetProperty();
                <partial name="Partials/HistoryInputGenerator" model="new KeyValuePair<CmsPropertyAttribute, KeyValuePair<PropertyInfo, object>>(propertyAttribute, new KeyValuePair<PropertyInfo, object>(property, historyChange.OldValue))" />
                <partial name="Partials/HistoryInputGenerator" model="new KeyValuePair<CmsPropertyAttribute, KeyValuePair<PropertyInfo, object>>(propertyAttribute, new KeyValuePair<PropertyInfo, object>(property, historyChange.NewValue))" />
            }
        }
    </div>
}